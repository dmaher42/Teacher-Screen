<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO and Browser Meta Tags -->
    <meta name="description" content="A customizable classroom management screen with widgets for teachers.">
    <meta name="author" content="Your Name">
    <meta name="theme-color" content="#3498db">
    
    <title>Custom Classroom Screen</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/themes.css">
    
    <!-- Favicon (placeholder) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“š</text></svg>">
    
    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js" defer></script>
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js" defer></script>
</head>

<!-- Set a default theme class on the body -->
<body class="memory-cue-theme">

    <noscript>
        <div class="noscript-message">
            For full functionality of this site, it is necessary to enable JavaScript.
        </div>
    </noscript>

    <nav id="top-nav">
        <div class="nav-tabs">
            <button class="nav-tab" data-tab="dashboard">Dashboard</button>
            <button class="nav-tab active" data-tab="classroom">Classroom</button>
            <button class="nav-tab" data-tab="reminders">Reminders</button>
            <button class="nav-tab" data-tab="planner">Planner</button>
            <button class="nav-tab" data-tab="timetable">Timetable</button>
            <button class="nav-tab" data-tab="notes">Notes</button>
        </div>
    <button id="open-projector-view" class="nav-tab" style="margin-left: auto;">Open Projector View</button>
    </nav>

    <main id="app-container" class="app-container">
        <!-- =====================================================
             STUDENT VIEW
             ===================================================== -->
        <section id="student-view" class="view student-view" role="region" aria-label="Student View">
            <div id="widgets-container" class="widgets-grid">
                <!-- Widgets are dynamically added here by JavaScript -->
                <div class="widget-placeholder">
                    <p>Add your first widget from the Teacher Controls!</p>
                </div>
            </div>
        </section>

        <!-- =====================================================
             TEACHER CONTROLS PANEL (REDESIGNED)
             ===================================================== -->
        <div class="teacher-panel" id="teacher-panel">
            <header class="panel-header">
                <h3>Teacher Controls</h3>
                <button id="close-teacher-panel" class="panel-close" aria-label="Close Teacher Controls">&times;</button>
            </header>
            <div class="panel-content">
                <!-- Control Cards -->
                <section class="control-card">
                    <details open>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/widget.svg" alt="" class="card-icon">
                            <h4>Add Widget</h4>
                        </summary>
                        <div class="card-body">
                            <p>Use the floating action button (+) to add widgets.</p>
                        </div>
                    </details>
                </section>
                <section class="control-card">
                    <details>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/timer.svg" alt="" class="card-icon">
                            <h4>Timer Control</h4>
                        </summary>
                        <div class="card-body">
                            <div class="control-group timer-inputs">
                                <input type="number" id="timer-hours" min="0" placeholder="HH" value="0">
                                <span>:</span>
                                <input type="number" id="timer-minutes" min="0" max="59" placeholder="MM" value="5">
                                <span>:</span>
                                <input type="number" id="timer-seconds" min="0" max="59" placeholder="SS" value="0">
                            </div>
                            <div class="button-group">
                                <button id="start-timer" class="control-button">Start Timer</button>
                                <button id="stop-timer" class="control-button">Stop Timer</button>
                            </div>
                            <div class="button-group" style="margin-top: 10px;">
                                <button class="control-button timer-quick-preset" data-minutes="5">5 min</button>
                                <button class="control-button timer-quick-preset" data-minutes="10">10 min</button>
                                <button class="control-button timer-quick-preset" data-minutes="15">15 min</button>
                            </div>
                        </div>
                    </details>
                </section>
                <section class="control-card">
                    <details>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/theme.svg" alt="" class="card-icon">
                            <h4>Theme</h4>
                        </summary>
                        <div class="card-body">
                            <div class="theme-selector" id="theme-selector">
                                <!-- Radio buttons will be populated by JS -->
                            </div>
                        </div>
                    </details>
                </section>
                <section class="control-card">
                    <details>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/background.svg" alt="" class="card-icon">
                            <h4>Background</h4>
                        </summary>
                        <div class="card-body">
                            <div id="background-selector" class="background-selector">
                                <!-- Background swatches will be populated by JS -->
                            </div>
                        </div>
                    </details>
                </section>
                <section class="control-card">
                    <details>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/preset.svg" alt="" class="card-icon">
                            <h4>Layouts &amp; Presets</h4>
                        </summary>
                        <div class="card-body">
                            <div class="input-group">
                                <label for="preset-name">Preset Name</label>
                                <input type="text" id="preset-name" placeholder="e.g., Morning Routine">
                            </div>
                            <div class="input-group">
                                <label for="preset-class-name">Class Name (optional)</label>
                                <input type="text" id="preset-class-name" placeholder="e.g., 8A Maths">
                            </div>
                            <div class="input-group">
                                <label for="preset-period">Period / Time Slot (optional)</label>
                                <input type="text" id="preset-period" placeholder="e.g., Morning, Afternoon">
                            </div>
                            <div class="button-group">
                                <button id="save-preset" class="control-button">Save / Overwrite</button>
                                <button id="reset-layout" class="control-button">Reset Layout</button>
                            </div>
                            <div class="button-group">
                                <button id="export-layout" class="control-button">Export</button>
                                <button id="import-layout" class="control-button">Import</button>
                            </div>
                            <div class="preset-filters">
                                <input type="text" id="preset-class-filter" placeholder="Filter by class name">
                                <select id="preset-period-filter">
                                    <option value="">All periods</option>
                                    <option value="Morning">Morning</option>
                                    <option value="Afternoon">Afternoon</option>
                                </select>
                            </div>
                            <div id="preset-list" class="preset-list" aria-live="polite"></div>
                        </div>
                    </details>
                </section>
                <section class="control-card">
                    <details>
                        <summary role="button" tabindex="0">
                            <img src="assets/icons/lesson-plan.svg" alt="" class="card-icon">
                            <h4>Lesson Plan</h4>
                        </summary>
                        <div class="card-body">
                            <div id="lesson-plan-editor"></div>
                        </div>
                    </details>
                </section>
            </div>
        </div>
        <div class="panel-backdrop"></div>

        <!-- =====================================================
             GLOBAL CONTROLS (REDESIGNED)
             ===================================================== -->
        <button id="fab" class="fab" aria-label="Add widget">+</button>

        <dialog id="widget-modal" aria-labelledby="widget-modal-title">
            <div class="modal-header">
                <h3 id="widget-modal-title">Add a Widget</h3>
                <button class="modal-close" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="widget-categories">
                    <!-- Categories and widgets will be populated by JS -->
                </div>
            </div>
        </dialog>

        <dialog id="help-dialog" aria-labelledby="help-dialog-title">
            <div class="modal-header">
                <h3 id="help-dialog-title">How to Use Teacher Controls</h3>
                <button class="modal-close" aria-label="Close Help">&times;</button>
            </div>
            <div class="modal-body">
                <ul>
                    <li>Use the navigation bar to switch between views.</li>
                    <li>Use the floating action button (+) to add widgets.</li>
                    <li>All changes save automatically to your browser.</li>
                </ul>
            </div>
            <div class="modal-actions">
                <button class="control-button modal-primary" data-close>Got it</button>
            </div>
        </dialog>

        <dialog id="tour-dialog" aria-labelledby="tour-dialog-title">
            <div class="modal-header">
                <h3 id="tour-dialog-title">Welcome to Your New Classroom Screen</h3>
                <button class="modal-close" aria-label="Close Tour">&times;</button>
            </div>
            <div class="modal-body">
                <p>Take a quick tour of the new layout:</p>
                <ol>
                    <li><strong>Top Navigation</strong>: Switch between the Classroom, Dashboard, and other tools.</li>
                    <li><strong>Teacher Panel</strong>: Access all controls from the slide-out panel on the right.</li>
                    <li><strong>Floating Action Button</strong>: Use the "+" button to add new widgets to the screen.</li>
                </ol>
            </div>
            <div class="modal-actions">
                <button class="control-button modal-primary" data-close>Start Teaching</button>
            </div>
        </dialog>

        <dialog id="import-dialog" aria-labelledby="import-dialog-title">
            <div class="modal-header">
                <h3 id="import-dialog-title">Import Layout & Presets</h3>
                <button class="modal-close" aria-label="Close Import">&times;</button>
            </div>
            <div class="modal-body">
                <p>Paste a layout + presets JSON below:</p>
                <textarea id="import-json-input" rows="8"></textarea>
                <div id="import-summary" class="import-summary"></div>
            </div>
            <div class="modal-actions">
                <button class="control-button modal-primary" id="confirm-import">Import</button>
                <button class="control-button" data-close>Cancel</button>
            </div>
        </dialog>
    </main>

    <!-- =====================================================
         JAVASCRIPT FILES
         ===================================================== -->
    <!-- Using 'defer' ensures scripts run after HTML is parsed, in order -->
    <script src="js/utils/layout-manager.js" defer></script>
    <script src="js/utils/background-manager.js" defer></script>
    <script src="assets/sounds/sound-data.js" defer></script>
    <script src="js/widgets/timer.js" defer></script>
    <script src="js/widgets/noise-meter.js" defer></script>
    <script src="js/widgets/noise-meter-widget.js" defer></script>
    <script src="js/widgets/name-picker.js" defer></script>
    <script src="js/widgets/qr-code-widget.js" defer></script>
    <script src="js/widgets/drawing-tool.js" defer></script>
    <script src="js/widgets/document-viewer.js" defer></script>
    <script src="js/widgets/mask-widget.js" defer></script>
    <script src="js/main.js" defer></script>

</body>
</html>
